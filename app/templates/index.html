{% extends 'layout.html' %}

{% block title %}Dashboard | ControlFlow{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0 fw-bold">Dashboard Overview</h2>
        <small class="text-muted">Last updated: {{ last_updated }}</small>
    </div>

    <!-- Key Performance Indicators -->
    <div class="row mb-4">
        <div class="col-md-4 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <p class="text-muted mb-1 small">Conversion Rate</p>
                    <h3 class="mb-0 fw-bold">{{ conversion_rate }}%</h3>
                    <p class="mb-0 small text-success">Quotations â†’ Sales</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <p class="text-muted mb-1 small">Fulfillment Rate</p>
                    <h3 class="mb-0 fw-bold">{{ fulfillment_rate }}%</h3>
                    <p class="mb-0 small text-primary">Orders Delivered</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <p class="text-muted mb-1 small">Material Acceptance</p>
                    <h3 class="mb-0 fw-bold">{{ material_acceptance_rate }}%</h3>
                    <p class="mb-0 small text-info">Quality Rate</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Stats Cards -->
    <div class="row mb-4">
        <!-- Quotations Card -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted mb-2 small fw-bold">Quotations</h6>
                    <h2 class="fw-bold mb-3">{{ total_quotations }}</h2>
                    <p class="mb-1 small"><span class="text-warning">Pending:</span> {{ pending_quotations }}</p>
                    <p class="mb-0 small"><span class="text-success">Accepted:</span> {{ accepted_quotations }}</p>
                </div>
            </div>
        </div>

        <!-- Sales Orders Card -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted mb-2 small fw-bold">Sales Orders</h6>
                    <h2 class="fw-bold mb-3">{{ total_sales_orders }}</h2>
                    <p class="mb-1 small"><span class="text-info">Approved:</span> {{ approved_sales_orders }}</p>
                    <p class="mb-0 small"><span class="text-success">Delivered:</span> {{ delivered_sales_orders }}</p>
                </div>
            </div>
        </div>

        <!-- Purchase Orders Card -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted mb-2 small fw-bold">Purchase Orders</h6>
                    <h2 class="fw-bold mb-3">{{ total_purchase_orders }}</h2>
                    <p class="mb-1 small"><span class="text-warning">Pending:</span> {{ pending_purchase_orders }}</p>
                    <p class="mb-0 small"><span class="text-success">Received:</span> {{ received_purchase_orders }}</p>
                </div>
            </div>
        </div>

        <!-- Inventory Card -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <h6 class="text-uppercase text-muted mb-2 small fw-bold">Inventory</h6>
                    <h2 class="fw-bold mb-3">{{ total_inventory_items }}</h2>
                    <p class="mb-1 small"><span class="text-danger">Low Stock:</span> {{ low_stock_items }}</p>
                    <p class="mb-0 small"><span class="text-primary">Locations:</span> {{ total_locations }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-0 py-3">
                    <h6 class="mb-0 fw-bold">Quick Actions</h6>
                </div>
                <div class="card-body">
                    <div class="d-flex flex-wrap gap-2">
                        <a href="{{ url_for('quotation_routes.manage_quotations') }}" class="btn btn-primary">
                            <i class="bi bi-plus-circle me-2"></i>New Quotation
                        </a>
                        <a href="{{ url_for('sales_order_routes.manage_sales_orders') }}" class="btn btn-success">
                            <i class="bi bi-cart-plus me-2"></i>New Sales Order
                        </a>
                        <a href="{{ url_for('purchase_order_routes.manage_purchase_orders') }}" class="btn btn-warning">
                            <i class="bi bi-box-arrow-in-down me-2"></i>New Purchase Order
                        </a>
                        <a href="{{ url_for('inventory_routes.manage_inventory') }}" class="btn btn-info">
                            <i class="bi bi-clipboard-check me-2"></i>Check Inventory
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .dashboard-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    .card {
        border-radius: 8px;
    }

    .card-header {
        border-radius: 8px 8px 0 0 !important;
    }
</style>
{% endblock %}